The model is automatically converting to fp16 for faster inference. If you want to disable the automatic precision, please manually add bf16/fp16/fp32=True to "AutoModelForCausalLM.from_pretrained".
Try importing flash-attention for faster inference...
Warning: import flash_attn rotary fail, please install FlashAttention rotary to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/rotary
Warning: import flash_attn rms_norm fail, please install FlashAttention layer_norm to get higher efficiency https://github.com/Dao-AILab/flash-attention/tree/main/csrc/layer_norm
Warning: import flash_attn fail, please install FlashAttention to get higher efficiency https://github.com/Dao-AILab/flash-attention
Namespace(port=8081, config='./config/qwen-14b-chat.yaml')
{
  "name": "qwen",
  "start_lora": false,
  "model_path": "llm_models/Qwen/Qwen-14B-Chat"
}
[0, 1]
Model directory: llm_models/Qwen/Qwen-14B-Chat
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/15 [00:00<00:10,  1.27it/s]Loading checkpoint shards:  13%|█▎        | 2/15 [00:01<00:10,  1.26it/s]Loading checkpoint shards:  20%|██        | 3/15 [00:02<00:09,  1.30it/s]Loading checkpoint shards:  27%|██▋       | 4/15 [00:03<00:08,  1.31it/s]Loading checkpoint shards:  33%|███▎      | 5/15 [00:03<00:07,  1.33it/s]Loading checkpoint shards:  40%|████      | 6/15 [00:04<00:06,  1.33it/s]Loading checkpoint shards:  47%|████▋     | 7/15 [00:05<00:05,  1.34it/s]Loading checkpoint shards:  53%|█████▎    | 8/15 [00:06<00:05,  1.34it/s]Loading checkpoint shards:  60%|██████    | 9/15 [00:06<00:04,  1.33it/s]Loading checkpoint shards:  67%|██████▋   | 10/15 [00:07<00:03,  1.34it/s]Loading checkpoint shards:  73%|███████▎  | 11/15 [00:08<00:02,  1.34it/s]Loading checkpoint shards:  80%|████████  | 12/15 [00:09<00:02,  1.34it/s]Loading checkpoint shards:  87%|████████▋ | 13/15 [00:09<00:01,  1.34it/s]Loading checkpoint shards:  93%|█████████▎| 14/15 [00:10<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 15/15 [00:11<00:00,  1.43it/s]Loading checkpoint shards: 100%|██████████| 15/15 [00:11<00:00,  1.35it/s]
INFO:     Started server process [464246]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8081 (Press CTRL+C to quit)
Current allocated memory: 12922664448
[2023-12-21 20:18:26] ", prompt:"你晚上吃饭了吗？", response:"'作为一个AI助手，我没有吃饭的需要。但是如果您需要建议或者推荐餐厅，我很乐意为您提供帮助。'"
INFO:     127.0.0.1:54276 - "POST /chat HTTP/1.1" 200 OK
